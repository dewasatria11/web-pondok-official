<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="csrf-token" content="{{CSRF_TOKEN}}" />
  <meta name="description"
    content="PPDB Pondok Pesantren Al Ikhsan Beji 2026/2027 kini dibuka. Daftar PPDB online, cek status pendaftaran, lihat syarat, biaya, brosur, dan alur pendaftaran resmi."
    data-i18n="meta.description.home" data-i18n-attr="content" data-i18n-skip-text />
  <meta name="keywords"
    content="PPDB Beji, Pondok Pesantren Al Ikhsan Beji, PPDB Online Beji, Daftar pondok pesantren beji, Pesantren Banyumas, Pendaftaran santri baru" />
  <meta property="og:title" content="Pondok Pesantren Al Ikhsan Beji | PPDB Online 2026/2027"
    data-i18n="meta.title.home" data-i18n-attr="content" data-i18n-skip-text />
  <meta property="og:description"
    content="Pendaftaran PPDB Al Ikhsan Beji 2026/2027 dibuka. Daftar online, cek status, syarat & biaya lengkap." />
  <meta property="og:image" content="https://alikhsan-beji.app/logo.png" />
  <meta property="og:url" content="https://alikhsan-beji.app" />
  <meta property="og:type" content="website" />
  <meta name="theme-color" content="#14532d" />

	  <link rel="preconnect" href="https://fonts.googleapis.com" />
	  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
	  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
	  <link rel="preconnect" href="https://sxbvadzcwpaovkhghttv.supabase.co" crossorigin />
	  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" />
	  <link rel="dns-prefetch" href="https://sxbvadzcwpaovkhghttv.supabase.co" />
  <!-- TODO: Ganti favicon/logo di bawah dengan aset milik pesantren -->
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/png" href="/favicon.png" sizes="32x32">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
  <link rel="manifest" href="/manifest.webmanifest">

  <title data-i18n="meta.title.home">Pondok Pesantren Al Ikhsan Beji | PPDB Online 2026/2027</title>

	  <link rel="stylesheet" href="/assets/css/tailwind.css?v=10" />
	  <link rel="stylesheet" href="/assets/css/scroll-animations.css?v=10" />
		  <link rel="stylesheet" href="/assets/css/hero-section.css?v=12" />
	  <script src="/i18n.js?v=10" defer></script>

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />

  <!-- Choices.js / Flatpickr / Toastify (opsional, kompatibel dgn snippet lama) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css" />

	  <!-- Font -->
		  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet" />

  <style>
    :root {
      --tw-font-sans: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif;
    }

    html,
    body {
      font-family: var(--tw-font-sans);
    }

    /* ===== RESPONSIVE ENHANCEMENTS ===== */

    /* Mobile-first responsive typography */
    @media (max-width: 640px) {
      h1 {
        font-size: 1.875rem !important;
        line-height: 2.25rem !important;
      }

      h2 {
        font-size: 1.5rem !important;
        line-height: 2rem !important;
      }

      h3 {
        font-size: 1.25rem !important;
        line-height: 1.75rem !important;
      }

      .text-lg {
        font-size: 1rem !important;
        line-height: 1.5rem !important;
      }

      .text-xl {
        font-size: 1.125rem !important;
        line-height: 1.75rem !important;
      }
    }

    /* Navbar mobile fixes - Simple and working */
    @media (max-width: 767px) {

      /* Navbar container */
      nav.sticky {
        position: sticky !important;
        top: 0 !important;
        z-index: 50 !important;
      }

      /* Navbar inner container */
      nav .max-w-7xl {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
      }

      /* Logo responsive */
      nav img.h-12,
      nav img[alt="Logo Al Ikhsan"] {
        max-height: 64px !important;
        height: 64px !important;
        width: auto !important;
      }

      /* Navbar row */
      nav>div>div.flex {
        min-height: 64px !important;
        height: auto !important;
      }

      /* Mobile menu button - ensure it's visible and clickable */
      nav button[type="button"][aria-label="Toggle menu"],
      nav button[type="button"][aria-label="Close menu"] {
        min-width: 44px !important;
        min-height: 44px !important;
        width: 44px !important;
        height: 44px !important;
        display: inline-flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 0.5rem !important;
      }

      /* Hide desktop nav */
      nav .hidden.md\:block {
        display: none !important;
      }

      /* Show mobile button */
      nav .md\:hidden {
        display: flex !important;
      }
    }

    @media (max-width: 640px) {

      /* Smaller logo on very small screens */
      nav img.h-12,
      nav img[alt="Logo Al Ikhsan"] {
        max-height: 64px !important;
        height: 64px !important;
      }
    }

    /* Hero section responsive */
    @media (max-width: 640px) {
      .hero-content {
        padding: 1.25rem 1rem !important;
      }

      section.relative.min-h-\[30vh\] {
        min-height: 26vh !important;
      }

      /* Adjust hero text size on mobile */
      section.relative h1 {
        font-size: 1.5rem !important;
        line-height: 2rem !important;
        margin-bottom: 0.75rem !important;
      }

      section.relative p {
        font-size: 0.9rem !important;
        line-height: 1.4rem !important;
        margin-bottom: 1.25rem !important;
      }

      /* Adjust buttons on mobile */
      section.relative a {
        padding: 0.625rem 1.25rem !important;
        font-size: 0.875rem !important;
      }
    }

    /* Tablet adjustments */
    @media (min-width: 641px) and (max-width: 1024px) {
      section.relative h1 {
        font-size: 2.1rem !important;
        line-height: 2.6rem !important;
      }
    }

    /* Better text readability on hero */
    .hero-text-shadow {
      text-shadow: 2px 4px 8px rgba(0, 0, 0, 0.4);
    }

    .hero-ppdb {
      position: relative;
      padding-top: 28px;
      padding-bottom: 84px;
      text-align: center;
      background: linear-gradient(180deg, #047857 0%, #10b981 100%);
      overflow: hidden;
    }

    .hero-inner {
      position: relative;
      z-index: 1;
      max-width: 900px;
      margin: 0 auto;
      color: #ffffff;
    }

    .hero-badge {
      display: inline-block;
      padding: 10px 32px;
      margin-bottom: 24px;
      border-radius: 999px;
      background: #ffffff;
      color: #047857;
      font-size: 14px;
      font-weight: 600;
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.12);
    }

    .hero-title {
      font-size: clamp(32px, 5vw, 56px);
      font-weight: 600;
      line-height: 1.15;
      margin-bottom: 12px;
      text-shadow: 0 8px 25px rgba(0, 0, 0, 0.35);
    }

    .hero-subtitle {
      font-size: clamp(20px, 3.5vw, 34px);
      font-weight: 500;
      line-height: 1.3;
      margin-bottom: 10px;
      color: rgba(255, 255, 255, 0.95);
      text-shadow: 0 6px 20px rgba(0, 0, 0, 0.35);
    }

    .hero-desc {
      font-size: 16px;
      line-height: 1.7;
      max-width: 780px;
      margin: 0 auto 20px;
      color: rgba(255, 255, 255, 0.92);
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 16px;
    }

    .btn-primary,
    .btn-secondary {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 12px 32px;
      border-radius: 999px;
      font-weight: 600;
      text-decoration: none;
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.22);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
    }

    .btn-primary {
      background: #fbbf24;
      color: #065f46;
    }

    .btn-secondary {
      background: #ffffff;
      color: #047857;
    }

    .btn-primary:hover,
    .btn-secondary:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 50px rgba(0, 0, 0, 0.28);
    }

    .hero-wave {
      position: absolute;
      left: 0;
      bottom: -6px;
      width: 100%;
      height: auto;
    }

    .news-grid {
      display: grid;
      gap: 2rem;
      grid-template-columns: minmax(0, 1fr);
      width: 100%;
    }

    .featured-berita .featured-image {
      position: relative;
      width: 100%;
      max-width: 100%;
      aspect-ratio: 16 / 9;
      overflow: hidden;
      border-top-left-radius: inherit;
      border-top-right-radius: inherit;
    }

    .featured-berita .featured-image img {
      display: block;
      width: 100%;
      height: 100%;
      max-width: 100%;
      object-fit: cover;
    }

    @media (min-width: 1024px) {
      .featured-berita .featured-image {
        aspect-ratio: 20 / 9;
        max-height: 520px;
      }
    }

    @media (max-width: 768px) {
      .featured-berita .featured-image {
        aspect-ratio: 4 / 3;
        max-height: 360px;
      }
    }

    @media (max-width: 640px) {
      .featured-berita .featured-image {
        aspect-ratio: 3 / 2;
        max-height: 240px;
      }
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

	    .quick-links {
	      display: flex;
	      flex-wrap: wrap;
	      justify-content: center;
	      align-items: center;
	      gap: 0.75rem;
	    }
	
	    .quick-links a {
	      display: inline-flex;
	      align-items: center;
	      gap: 0.35rem;
	      padding: 0.6rem 1.25rem;
	      border-radius: 999px;
	      border: 1px solid rgba(4, 120, 87, 0.2);
	      color: #047857;
	      font-weight: 600;
	      justify-content: center;
	      text-align: center;
	      transition: background 0.2s ease, color 0.2s ease, box-shadow 0.2s ease;
	    }

	    .quick-links a:hover {
	      background: rgba(4, 120, 87, 0.08);
	      color: #065f46;
	      box-shadow: 0 10px 20px rgba(4, 120, 87, 0.15);
	    }
	
	    /* Quick links on mobile: 2-column grid, stacked icon + text */
	    @media (max-width: 768px) {
	      .quick-links {
	        display: grid;
	        grid-template-columns: repeat(2, minmax(0, 1fr));
	        gap: 0.75rem;
	        padding: 0 0.25rem;
	      }
	
	      .quick-links a {
	        width: 100%;
	        flex-direction: column;
	        gap: 0.5rem;
	        padding: 0.75rem 0.75rem;
	        border-radius: 16px;
	      }
	
	      .quick-links a i {
	        font-size: 1.1rem;
	      }
	
	      .quick-links a span {
	        line-height: 1.15;
	      }
	    }

    @media (min-width: 1024px) {
      .news-grid {
        grid-template-columns: minmax(0, 1.4fr) minmax(260px, 1fr);
        align-items: flex-start;
      }
    }

    @media (max-width: 640px) {
      .hero-ppdb {
        padding-top: 44px;
        padding-bottom: 90px;
      }

      .btn-primary,
      .btn-secondary {
        width: 100%;
        max-width: 260px;
      }
    }

    @media (max-width: 1023px) {
      .news-grid {
        grid-template-columns: minmax(0, 1fr);
        justify-items: center;
      }

      .news-grid>* {
        width: min(100%, 640px);
      }
    }

    /* Gelombang cards responsive stacking */
    @media (max-width: 768px) {
      #gelombangContainer {
        grid-template-columns: 1fr !important;
      }
    }

    /* WhatsApp widget responsive */
    @media (max-width: 640px) {
      .whatsapp-widget {
        padding: 0.75rem 1rem !important;
        font-size: 0.875rem !important;
      }

      .whatsapp-widget .flex-col span:first-child {
        font-size: 0.75rem !important;
      }

      .whatsapp-widget .flex-col span:last-child {
        font-size: 0.625rem !important;
      }
    }

    /* Line clamp utilities for text truncation */
    .line-clamp-2,
    .line-clamp-3 {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .line-clamp-2 {
      -webkit-line-clamp: 2;
      line-clamp: 2;
    }

    .line-clamp-3 {
      -webkit-line-clamp: 3;
      line-clamp: 3;
    }

    /* Card hover effects - disable on touch devices */
    @media (hover: none) {
      .hover\:-translate-y-2:hover {
        transform: none !important;
      }
    }

    /* Smooth transitions */
    * {
      -webkit-tap-highlight-color: transparent;
    }

    /* Improve button touch targets on mobile */
    @media (max-width: 640px) {

      a,
      button {
        min-height: 44px;
        min-width: 44px;
      }
    }

    /* Container responsive padding */
    @media (max-width: 640px) {
      .container {
        padding-left: 1rem !important;
        padding-right: 1rem !important;
      }
    }

    /* Mobile menu - Simple and working */
    @media (max-width: 767px) {

      /* Mobile menu panel */
      .mobile-menu {
        width: 100vw !important;
        max-width: 100vw !important;
      }

      /* Mobile menu logo */
      .mobile-menu img {
        max-height: 64px !important;
        height: 64px !important;
      }

      /* Mobile menu links - ensure touch targets */
      .mobile-menu a {
        min-height: 44px !important;
        display: flex !important;
        align-items: center !important;
      }

      /* Mobile menu summary */
      .mobile-menu summary {
        min-height: 44px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: space-between !important;
        cursor: pointer !important;
        list-style: none !important;
      }

      .mobile-menu summary::-webkit-details-marker {
        display: none !important;
      }

      .mobile-menu summary::marker {
        display: none !important;
      }

      /* Mobile menu sub-items */
      .mobile-menu details>div {
        padding-left: 1rem !important;
        border-left: 2px solid #e5e7eb !important;
      }

      .mobile-menu details a {
        font-size: 0.875rem !important;
        min-height: 64px !important;
      }

      /* Details arrow rotation */
      .mobile-menu details[open] summary i {
        transform: rotate(180deg) !important;
      }
    }

    @media (max-width: 640px) {
      .mobile-menu {
        width: 100vw !important;
        max-width: 100vw !important;
      }

      .mobile-menu a,
      .mobile-menu summary {
        font-size: 0.9rem !important;
        padding: 0.625rem 0.875rem !important;
      }
    }

    #yellowBlob {
      will-change: transform;
      transition: transform 0.2s ease-out;
    }

    @supports (animation-timeline: scroll()) {
      #yellowBlob[data-css-parallax="true"] {
        animation: yellowBlobParallax linear both;
        animation-timeline: scroll();
        animation-range: 0 40vh;
      }

      @keyframes yellowBlobParallax {
        from {
          transform: translate3d(0, 0, 0);
        }

        to {
          transform: translate3d(0, -120px, 0);
        }
      }
    }

    /* ===== IMAGE SLIDER STYLES (Card Minimalis dengan Slide Animation) ===== */
    #imageSliderContainer {
      position: relative;
      width: 100%;
      max-width: 1000px;
      margin: 0 auto;
      padding: 1.5rem 1rem;
      height: 380px;
      /* Ukuran dikecilkan */
    }

    #imageSlider {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
      background: #f5f5f5;
    }

    .slider-track {
      display: flex;
      width: 100%;
      height: 100%;
      transition: transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      will-change: transform;
    }

    .slider-slide {
      min-width: 100%;
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      #imageSliderContainer {
        height: 280px;
        padding: 1rem;
      }
    }

    @media (max-width: 640px) {
      #imageSliderContainer {
        height: 220px;
        padding: 0.75rem;
      }

      #imageSlider {
        border-radius: 12px;
      }
    }
  </style>
</head>

<body class="min-h-screen flex flex-col bg-white text-gray-800">
  <!-- HEADER -->
  <header class="relative z-50">
    <div id="superHeader" class="bg-yellow-300 text-gray-900 text-xs tracking-wide">
      <div class="max-w-7xl mx-auto flex flex-wrap items-center justify-between gap-3 px-4 sm:px-6 lg:px-8 py-1.5">
        <button type="button"
          class="inline-flex items-center gap-2 bg-white/40 hover:bg-white/60 text-gray-900 px-3 py-1.5 rounded-full text-[11px] sm:text-xs font-semibold uppercase shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900 transition disabled:opacity-60 disabled:cursor-not-allowed"
          data-install-button
          data-install-unavailable-text="Install tersedia setelah browser mendukung pemasangan aplikasi.">
          <i class="bi bi-cloud-arrow-down-fill text-base" aria-hidden="true"></i>
          <span data-i18n="nav.install">Download App</span>
        </button>
        <div class="flex items-center gap-2 sm:gap-3 text-[11px] sm:text-xs font-semibold uppercase">
          <button type="button" data-setlang="id"
            class="inline-flex items-center gap-1 text-gray-900 hover:text-gray-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900 transition"
            aria-label="Bahasa Indonesia" data-i18n="nav.language.id" data-i18n-attr="aria-label" data-i18n-skip-text>
            <span aria-hidden="true" class="text-base leading-none">ğŸ‡®ğŸ‡©</span>
            <span>ID</span>
          </button>
          <span class="text-gray-600" aria-hidden="true">|</span>
          <button type="button" data-setlang="en"
            class="inline-flex items-center gap-1 text-gray-900 hover:text-gray-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-900 transition"
            aria-label="English" data-i18n="nav.language.en" data-i18n-attr="aria-label" data-i18n-skip-text>
            <span aria-hidden="true" class="text-base leading-none">ğŸ‡¬ğŸ‡§</span>
            <span>EN</span>
          </button>
        </div>
      </div>
    </div>
  </header>
  <!-- NAVBAR -->
  <nav class="sticky top-0 z-[130] bg-transparent backdrop-blur-none transition-all duration-300" data-nav-root>
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16 min-h-[64px]">
        <!-- Logo -->
        <div class="flex-shrink-0 flex items-center">
          <a href="/" class="flex items-center">
            <img src="/assets/img/logo-alikhsan.png" alt="Logo Al Ikhsan" class="h-16 w-auto" />
          </a>
        </div>

        <!-- Desktop Navigation -->
        <div class="hidden md:block">
          <div class="flex items-baseline space-x-4">
            <a href="/" class="text-gray-600 hover:text-brand-600 px-3 py-2 rounded-md text-sm font-medium"
              data-nav-link data-i18n="nav.home">Beranda</a>

            <!-- Dropdown Informasi -->
            <div class="relative">
              <button type="button"
                class="text-gray-600 hover:text-brand-600 px-3 py-2 rounded-md text-sm font-medium flex items-center transition"
                data-dropdown-toggle="desktopInfoDropdown" aria-expanded="false" aria-controls="desktopInfoDropdown"
                aria-haspopup="true">
                <span data-i18n="nav.info">Informasi</span>
                <i class="bi bi-caret-down-fill ml-1 text-xs transition-transform duration-200" data-dropdown-caret></i>
              </button>
              <div id="desktopInfoDropdown"
                class="absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg py-2 z-50 border border-gray-100 hidden"
                role="menu">
                <a href="/alur-pendaftaran.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"
                  data-nav-link data-i18n="nav.flow">Alur Pendaftaran</a>
                <a href="/syarat-pendaftaran.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"
                  data-nav-link data-i18n="nav.requirements">Syarat Pendaftaran</a>
                <a href="/biaya.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50" data-nav-link
                  data-i18n="nav.fees">Biaya</a>
              </div>
            </div>

            <a href="/brosur.html" class="text-gray-600 hover:text-brand-600 px-3 py-2 rounded-md text-sm font-medium"
              data-nav-link data-i18n="nav.brochure">Brosur</a>
            <a href="/kontak.html" class="text-gray-600 hover:text-brand-600 px-3 py-2 rounded-md text-sm font-medium"
              data-nav-link data-i18n="nav.contact">Kontak</a>
          </div>
        </div>

        <!-- CTA Button Desktop -->
        <div class="hidden md:block">
          <a href="/login"
            class="bg-brand-700 hover:bg-brand-800 text-white px-6 py-2 rounded-lg text-sm font-medium shadow-md hover:shadow-lg"
            data-i18n="nav.admin">Admin</a>
        </div>

        <!-- Mobile menu button -->
        <div class="md:hidden">
          <button type="button" aria-label="Toggle menu" aria-expanded="false" aria-controls="mobileNavMenu"
            class="inline-flex items-center justify-center p-2 rounded-md text-gray-600 hover:text-brand-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-brand-500"
            data-mobile-toggle>
            <i class="bi bi-list text-xl" data-mobile-icon="open"></i>
            <i class="bi bi-x-lg text-xl hidden" data-mobile-icon="close"></i>
          </button>
        </div>
      </div>
    </div>

  </nav>

  <!-- MOBILE NAV OVERLAY -->
  <div id="mobileNavBackdrop" class="md:hidden absolute inset-0 z-[140] bg-black/60 hidden" data-mobile-backdrop></div>

  <div id="mobileNavMenu"
    class="md:hidden absolute inset-y-0 left-0 z-[141] mobile-menu bg-white shadow-2xl border-r border-gray-200 overflow-y-auto hidden"
    data-mobile-menu role="dialog" aria-modal="true">
    <div class="flex items-center justify-between p-4 border-b border-gray-200 bg-white">
      <div class="flex items-center">
        <img src="/assets/img/logo-alikhsan.png" alt="Logo Al Ikhsan" class="h-12 w-auto" />
      </div>
      <button type="button" aria-label="Close menu"
        class="p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100" data-close-mobile>
        <i class="bi bi-x-lg text-xl"></i>
      </button>
    </div>

    <div class="px-2 pt-4 pb-6 space-y-1">
      <a href="/"
        class="block px-4 py-3 rounded-md text-base font-medium text-gray-700 hover:text-brand-700 hover:bg-gray-50"
        data-nav-link data-i18n="nav.home" data-close-mobile>Beranda</a>

      <details class="px-1">
        <summary
          class="cursor-pointer text-gray-700 hover:text-brand-700 hover:bg-gray-50 px-4 py-3 rounded-md text-base font-medium flex items-center justify-between"
          data-i18n="nav.info">
          <span>Informasi</span>
          <i class="bi bi-chevron-down text-xs"></i>
        </summary>
        <div class="pl-4 space-y-1 mt-1">
          <a href="/alur-pendaftaran.html" class="block px-4 py-2 text-sm rounded-md hover:bg-gray-50" data-nav-link
            data-i18n="nav.flow" data-close-mobile>Alur Pendaftaran</a>
          <a href="/syarat-pendaftaran.html" class="block px-4 py-2 text-sm rounded-md hover:bg-gray-50" data-nav-link
            data-i18n="nav.requirements" data-close-mobile>Syarat Pendaftaran</a>
          <a href="/biaya.html" class="block px-4 py-2 text-sm rounded-md hover:bg-gray-50" data-nav-link
            data-i18n="nav.fees" data-close-mobile>Biaya</a>
        </div>
      </details>

      <a href="/brosur.html" class="block px-4 py-3 rounded-md text-base font-medium text-gray-700 hover:bg-gray-50"
        data-nav-link data-i18n="nav.brochure" data-close-mobile>Brosur</a>
      <a href="/kontak.html" class="block px-4 py-3 rounded-md text-base font-medium text-gray-700 hover:bg-gray-50"
        data-nav-link data-i18n="nav.contact" data-close-mobile>Kontak</a>

      <div class="pt-4 pb-2 px-2 border-t border-gray-200 mt-4">
        <a href="/login.html"
          class="w-full bg-brand-700 hover:bg-brand-800 text-white px-4 py-3 rounded-lg text-base font-medium shadow-md hover:shadow-lg block text-center"
          data-i18n="nav.admin" data-close-mobile>Admin</a>
      </div>
    </div>
  </div>
  <!-- END MOBILE NAV OVERLAY -->

  <!-- MAIN -->
  <main class="flex-1">
    <!-- HERO SECTION - SMPDISS Style Carousel -->
    <section class="hero-carousel" id="heroSection">
      <!-- Light Mint/Green Background -->
      <div class="hero-bg"></div>

      <!-- Decorative Elements -->
      <div class="hero-decor hero-decor-1"></div>
      <div class="hero-decor hero-decor-2"></div>

      <!-- Hero Main Container -->
      <div class="hero-wrapper">
        <!-- LEFT: Text Content Area -->
        <div class="hero-text-area">
          <!-- Slide 1 Text (Active by default) -->
	          <div class="hero-slide-text hero-slide-text--active" data-slide="0">
	            <p class="hero-arabic-text">Ø£ÙÙ‡Ù’Ù„Ù‹Ø§ ÙˆÙØ³ÙÙ‡Ù’Ù„Ù‹Ø§</p>
	            <h1 class="hero-title">
	              <span data-i18n="hero.carousel.slide1.titleLine1">Penerimaan Peserta Didik Baru Terintegrasi</span><br>
	              <span class="hero-title-highlight" data-i18n="hero.carousel.slide1.titleHighlight">MTs, MA, dan Pondok Pesantren Al Ikhsan Beji</span>
	            </h1>
	            <p class="hero-desc" data-i18n="hero.carousel.slide1.desc">
	              Bergabunglah menjadi santri Pondok Pesantren Al Ikhsan Beji.
	              Pendidikan islami terpadu dengan pembinaan akhlak, tahfidz Al-Qur'an,
	              dan ilmu pengetahuan yang membentuk generasi Qur'ani dan berprestasi.
	            </p>
	            <div class="hero-cta-group">
	              <a href="/daftar.html" class="hero-cta hero-cta-primary">
	                <i class="bi bi-pencil-square"></i>
	                <span data-i18n="hero.carousel.cta.apply">Daftar</span>
	              </a>
	              <a href="/cek-status.html" class="hero-cta hero-cta-secondary">
	                <i class="bi bi-search"></i>
	                <span data-i18n="hero.carousel.cta.status">Cek Status</span>
	              </a>
	            </div>
	          </div>

          <!-- Slide 2 Text -->
	          <div class="hero-slide-text" data-slide="1">
	            <p class="hero-arabic-text">Ù…ÙÙ†Ù’ Ø¬ÙØ¯ÙÙ‘ ÙˆÙØ¬ÙØ¯Ù</p>
	            <h1 class="hero-title">
	              <span data-i18n="hero.carousel.slide2.titleLine1">Karakter Islami</span><br>
	              <span class="hero-title-highlight" data-i18n="hero.carousel.slide2.titleHighlight">& Program Bahasa Arab - Inggris Berstandar Unggul</span>
	            </h1>
	            <p class="hero-desc" data-i18n="hero.carousel.slide2.desc">
	              Pembinaan akhlakul karimah, program tahfidz Al-Qur'an intensif,
	              dan disiplin santri yang membentuk pribadi berakhlak mulia
	              serta berprestasi di bidang akademik maupun non-akademik.
	            </p>
	            <div class="hero-cta-group">
	              <a href="/daftar.html" class="hero-cta hero-cta-primary">
	                <i class="bi bi-pencil-square"></i>
	                <span data-i18n="hero.carousel.cta.apply">Daftar</span>
	              </a>
	              <a href="/cek-status.html" class="hero-cta hero-cta-secondary">
	                <i class="bi bi-search"></i>
	                <span data-i18n="hero.carousel.cta.status">Cek Status</span>
	              </a>
	            </div>
	          </div>

          <!-- Slide 3 Text -->
	          <div class="hero-slide-text" data-slide="2">
	            <p class="hero-arabic-text">Ø·ÙÙ„ÙØ¨Ù Ø§Ù„Ø¹ÙÙ„Ù’Ù…Ù ÙÙØ±ÙÙŠØ¶ÙØ©ÙŒ</p>
	            <h1 class="hero-title">
	              <span data-i18n="hero.carousel.slide3.titleLine1">Berbasis Disiplin Akhlak</span><br>
	              <span class="hero-title-highlight" data-i18n="hero.carousel.slide3.titleHighlight">& Wawasan Global</span>
	            </h1>
	            <p class="hero-desc" data-i18n="hero.carousel.slide3.desc">
	              Kehidupan berasrama yang mendidik, bimbingan ustadz/ustadzah profesional,
	              dan persiapan masa depan santri untuk menjadi pemimpin
	              yang siap menghadapi tantangan dunia modern.
	            </p>
	            <div class="hero-cta-group">
	              <a href="/daftar.html" class="hero-cta hero-cta-primary">
	                <i class="bi bi-pencil-square"></i>
	                <span data-i18n="hero.carousel.cta.apply">Daftar</span>
	              </a>
	              <a href="/cek-status.html" class="hero-cta hero-cta-secondary">
	                <i class="bi bi-search"></i>
	                <span data-i18n="hero.carousel.cta.status">Cek Status</span>
	              </a>
	            </div>
	          </div>
        </div>

        <!-- RIGHT: Image Card Area -->
        <div class="hero-image-area">
          <!-- Left Arrow (attached to card) -->
          <button type="button" class="hero-arrow hero-arrow-prev" aria-label="Previous slide" id="heroPrev">
            <i class="bi bi-chevron-left"></i>
          </button>

          <!-- Image Card Container -->
          <div class="hero-image-card">
            <div class="hero-image-cropper">
              <!-- Dark green background behind image -->
              <div class="hero-image-bg"></div>
		              <div class="hero-slide-image hero-slide-image--active" data-slide="0" style="--scale: 1.5; --y: -20px;">
		                <img src="/assets/img/hero-santri-placeholder.svg" width="1600" height="900"
		                  alt="Santri Al Ikhsan Beji - Slide 1" loading="eager" fetchpriority="high" decoding="async">
		              </div>
		              <div class="hero-slide-image" data-slide="1" style="--scale: 1.6; --y: -40px;">
		                <img src="/assets/img/hero-santri-placeholder.svg" width="1600" height="900"
		                  alt="Santri Al Ikhsan Beji - Slide 2" loading="lazy" decoding="async">
		              </div>
		              <div class="hero-slide-image" data-slide="2" style="--scale: 1.45; --y: -25px;">
		                <img src="/assets/img/hero-santri-placeholder.svg" width="1600" height="900"
		                  alt="Santri Al Ikhsan Beji - Slide 3" loading="lazy" decoding="async">
		              </div>
            </div>
          </div>

          <!-- Right Arrow (attached to card) -->
          <button type="button" class="hero-arrow hero-arrow-next" aria-label="Next slide" id="heroNext">
            <i class="bi bi-chevron-right"></i>
          </button>
        </div>
      </div>

      <!-- Slider Dots -->
      <div class="hero-dots" id="heroDots">
        <button type="button" class="hero-dot hero-dot--active" data-slide="0" aria-label="Go to slide 1"></button>
        <button type="button" class="hero-dot" data-slide="1" aria-label="Go to slide 2"></button>
        <button type="button" class="hero-dot" data-slide="2" aria-label="Go to slide 3"></button>
      </div>

      <!-- Wave Divider -->
      <div class="hero-wave">
        <svg viewBox="0 0 1440 120" preserveAspectRatio="none" aria-hidden="true">
          <path fill="#ffffff"
            d="M0,64L80,69.3C160,75,320,85,480,80C640,75,800,53,960,48C1120,43,1280,53,1360,58.7L1440,64L1440,120L1360,120C1280,120,1120,120,960,120C800,120,640,120,480,120C320,120,160,120,80,120L0,120Z">
          </path>
        </svg>
      </div>
    </section>

    <!-- SEO HEADING SECTION -->
    <section class="py-12 bg-white border-b border-gray-100">
      <div class="container mx-auto px-4 reveal reveal-fade-up">
        <div class="sr-only">
          <div>
            <h3 data-i18n="seo.headings.flow">Alur Pendaftaran</h3>
            <p>Ikuti tahapan registrasi online, verifikasi, hingga daftar ulang secara terperinci.</p>
          </div>
          <div>
            <h3 data-i18n="seo.headings.requirements">Syarat Pendaftaran</h3>
            <p>Siapkan dokumen administrasi, ijazah, dan ketentuan umur sesuai panduan resmi.</p>
          </div>
          <div>
            <h3 data-i18n="seo.headings.fees">Biaya Pendidikan</h3>
            <p>Transparansi uang pangkal, SPP, dan kebutuhan lain disajikan secara jelas.</p>
          </div>
          <div>
            <h3 data-i18n="seo.headings.brochure">Brosur PPDB</h3>
            <p>Unduh brosur digital untuk melihat fasilitas, program unggulan, dan jadwal PPDB.</p>
          </div>
          <div>
            <h3 data-i18n="seo.headings.contact">Kontak & Informasi Lengkap</h3>
            <p>Konsultasikan kebutuhan keluarga melalui WhatsApp, telepon, atau kunjungan langsung.</p>
          </div>
        </div>
		        <div class="quick-links text-sm">
		          <a href="/daftar.html" class="reveal reveal-fade-up delay-1">
		            <i class="bi bi-pencil-square"></i>
		            <span data-i18n="hero.ctaApply">Daftar Sekarang</span>
		          </a>
		          <a href="/alur-pendaftaran.html" class="reveal reveal-fade-up delay-2">
		            <i class="bi bi-arrow-right-circle"></i>
		            <span data-i18n="seo.headings.flow">Alur Pendaftaran</span>
		          </a>
		          <a href="/syarat-pendaftaran.html" class="reveal reveal-fade-up delay-3">
		            <i class="bi bi-check-circle"></i>
		            <span data-i18n="seo.headings.requirements">Syarat Pendaftaran</span>
		          </a>
		          <a href="/biaya.html" class="reveal reveal-fade-up delay-4">
		            <i class="bi bi-cash-stack"></i>
		            <span data-i18n="seo.headings.fees">Biaya Pendidikan</span>
		          </a>
		          <a href="/brosur.html" class="reveal reveal-fade-up delay-5">
		            <i class="bi bi-file-earmark-text"></i>
		            <span data-i18n="seo.headings.brochure">Brosur PPDB</span>
		          </a>
		          <a href="/kontak.html" class="reveal reveal-fade-up delay-6">
		            <i class="bi bi-telephone-forward"></i>
		            <span data-i18n="seo.headings.contact">Kontak & Informasi Lengkap</span>
		          </a>
		        </div>
		      </div>
		    </section>

	    <!-- GELOMBANG PENDAFTARAN -->
	    <section class="py-12 bg-gray-50">
	      <!-- Section header with reveal animation -->
	      <div class="container mx-auto px-4">
	        <div class="flex justify-center mb-12 reveal reveal-fade-up">
	          <div class="w-full lg:w-2/3 text-center">
	            <h2 class="text-3xl lg:text-4xl font-bold mb-3 text-gray-800" data-i18n="sections.gelombang.title">Gelombang
	              Pendaftaran</h2>

	          </div>
	        </div>

	        <!-- Dynamic Gelombang Cards -->
	        <div id="gelombangContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
	          <!-- Loading skeleton -->
	          <div class="text-center py-12 col-span-full">
	            <div class="spinner-border text-primary" role="status">
	              <span class="visually-hidden" data-i18n="sections.gelombang.loadingAlt">Memuat data gelombang...</span>
	            </div>
	            <p class="text-gray-500 mt-3" data-i18n="sections.gelombang.loading">Memuat data gelombang...</p>
	          </div>
	        </div>
	      </div>
	    </section>

	    <!-- WHY SECTION (Modern 2-Column Layout) -->
	    <section class="py-16 bg-white reveal reveal-fade-up">
	      <div class="container mx-auto px-4">
	        <div class="max-w-6xl mx-auto">
	          <div id="whySectionContent" class="grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 items-center">
	            <!-- Loading state -->
	            <div class="animate-pulse lg:col-span-2">
	              <div class="h-8 bg-gray-200 rounded mb-4 max-w-md"></div>
	              <div class="h-4 bg-gray-200 rounded mb-2 max-w-xl"></div>
	              <div class="h-4 bg-gray-200 rounded mb-6 max-w-lg"></div>
	            </div>
	          </div>
	        </div>
	      </div>
	    </section>

	    <!-- IMAGE SLIDER SECTION (Card Minimalis - Slide Animation) -->
	    <section class="py-8 bg-gray-50 reveal reveal-zoom">
	      <div id="imageSliderContainer">
	        <div id="imageSlider">
	          <div id="sliderTrack" class="slider-track">
	            <!-- Fallback gradient -->
	            <div id="sliderFallback" class="slider-slide"
	              style="background: linear-gradient(135deg, #047857 0%, #064e3b 100%);"></div>
	          </div>
	        </div>
	      </div>
	    </section>

    <!-- BERITA & ARTIKEL -->
    <section class="py-16 bg-gray-50">
      <div class="container mx-auto px-4">
        <div class="flex flex-col lg:flex-row items-start lg:items-center gap-4 mb-10 reveal reveal-fade-up">
          <div class="flex-1">
            <h2 class="text-3xl lg:text-4xl font-bold text-gray-900" data-i18n="sections.berita.title">Berita Terkini
            </h2>
            <div class="w-16 h-1 bg-brand-600 rounded-full mt-3 mb-4"></div>
            <p class="text-lg text-gray-600 max-w-2xl" data-i18n="sections.berita.subtitle">Berita terbaru seputar
              Pondok Pesantren Al Ikhsan Beji</p>
          </div>
          <div class="w-full lg:w-auto">
            <a href="/berita.html"
              class="ml-auto inline-flex items-center text-brand-700 font-semibold text-base hover:text-brand-800 transition">
              <span data-i18n="sections.berita.viewAll">Lihat Semua</span>
              <i class="bi bi-arrow-right-short text-2xl"></i>
            </a>
          </div>
        </div>

        <!-- Dynamic Berita Cards -->
        <div id="beritaContainer" class="news-grid mb-8 reveal reveal-fade-up delay-2">
          <!-- Loading skeleton -->
          <div class="text-center py-12 col-span-full">
            <div class="animate-pulse">
              <div class="h-8 bg-gray-200 rounded mb-4 max-w-md mx-auto"></div>
              <div class="h-4 bg-gray-200 rounded mb-2 max-w-xl mx-auto"></div>
            </div>
            <p class="text-gray-500 mt-3" data-i18n="sections.berita.loading">Memuat berita...</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="bg-white text-gray-600 py-6 shadow-2xl border-t border-gray-200 mt-auto reveal reveal-fade-up">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <p class="text-sm"><span data-i18n="footer.copyright">Â© 2026/2027 Pondok Pesantren Al Ikhsan Beji. All rights
          reserved.</span> <span class="hidden sm:inline" data-i18n="footer.credit">Development by Tim IT
          Pesantren</span></p>
    </div>
  </footer>



  <!-- Vendors JS (optional) -->
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script>
    // Shim toastr -> toastify agar kompatibel dgn snippet lama
    window.toastr = {
      success(msg) { Toastify({ text: msg, duration: 4000, close: true, gravity: 'top', position: 'right', style: { background: '#10b981', color: '#fff' } }).showToast(); },
      error(msg) { Toastify({ text: msg, duration: 4000, close: true, gravity: 'top', position: 'right', style: { background: '#ef4444', color: '#fff' } }).showToast(); },
      warning(msg) { Toastify({ text: msg, duration: 4000, close: true, gravity: 'top', position: 'right', style: { background: '#f59e0b', color: '#fff' } }).showToast(); },
      info(msg) { Toastify({ text: msg, duration: 4000, close: true, gravity: 'top', position: 'right', style: { background: '#3b82f6', color: '#fff' } }).showToast(); }
    }
  </script>


  <!-- Gelombang Data Loader (Business Logic: Active-based Status) -->
  <script>
    const STATE_COLOR = {
      ACTIVE: "green",
      UPCOMING: "blue",
      CLOSED: "gray",
      NOT_ACTIVE: "gray"
    };

    const COLOR_MAP = {
      green: {
        border: "border-green-200",
        badge: "bg-green-500",
        icon: "bg-gradient-to-br from-green-500 to-green-600",
        iconText: "text-green-500"
      },
      blue: {
        border: "border-blue-200",
        badge: "bg-blue-500",
        icon: "bg-gradient-to-br from-blue-500 to-blue-600",
        iconText: "text-blue-500"
      },
      gray: {
        border: "border-gray-200",
        badge: "bg-gray-500",
        icon: "bg-gradient-to-br from-gray-500 to-gray-600",
        iconText: "text-gray-500"
      }
    };

    const STATUS_KEY_MAP = {
      ACTIVE: "active",
      UPCOMING: "upcoming",
      CLOSED: "closed",
      NOT_ACTIVE: "notActive"
    };

    const translateText = (key, replacements) =>
      typeof window.__ === "function" ? window.__(key, replacements) : key;

    const getStatusKey = (stateKey) => STATUS_KEY_MAP[stateKey] || STATUS_KEY_MAP.NOT_ACTIVE;
    const getStatusLabel = (stateKey) => translateText(`sections.gelombang.status.${getStatusKey(stateKey)}`);
    const getStatusBadgeText = (stateKey) => translateText(`sections.gelombang.statusBadge.${getStatusKey(stateKey)}`);
    const getButtonLabel = (stateKey) => translateText(`sections.gelombang.button.${getStatusKey(stateKey)}`);
    const getYearText = (year) => `${translateText("sections.gelombang.yearPrefix")} ${year}`;

    const parseNumericId = (value) => {
      const num = Number(value);
      return Number.isFinite(num) ? num : null;
    };

    const isTrueish = (value) => {
      if (value === true) return true;
      if (value === false || value === null || value === undefined) return false;
      if (typeof value === "string") {
        const trimmed = value.trim().toLowerCase();
        if (trimmed === "true" || trimmed === "1" || trimmed === "ya" || trimmed === "yes") return true;
        if (trimmed === "false" || trimmed === "0" || trimmed === "tidak" || trimmed === "no") return false;
      }
      if (typeof value === "number") {
        return !Number.isNaN(value) && value !== 0;
      }
      return Boolean(value);
    };

    function decorateGelombang(waves, activeId) {
      if (!Array.isArray(waves)) return [];

      const setState = (record, stateKey = "NOT_ACTIVE") => {
        if (!record) return;
        const normalized = (stateKey || "NOT_ACTIVE").toUpperCase();
        record._state = normalized;
        const colorKey = STATE_COLOR[normalized] || "gray";
        record._color = colorKey;
        record._label = getStatusLabel(normalized);
      };

      const activeIdNum = parseNumericId(activeId);
      let activeWave =
        waves.find((wave) => parseNumericId(wave.id) === activeIdNum) ||
        waves.find((wave) => isTrueish(wave.is_active));

      const getOrder = (wave, index) => {
        const order = Number(wave?.urutan);
        return Number.isFinite(order) ? order : index;
      };

      const now = new Date();

      waves.forEach((wave, index) => {
        if (!wave) return;

        const waveId = parseNumericId(wave.id);

        if (activeWave && waveId === parseNumericId(activeWave.id)) {
          setState(wave, "ACTIVE");
          return;
        }

        if (activeWave) {
          const waveOrder = getOrder(wave, index);
          const activeOrder = getOrder(activeWave, waves.indexOf(activeWave));

          if (Number.isFinite(waveOrder) && Number.isFinite(activeOrder)) {
            if (waveOrder > activeOrder) {
              setState(wave, "UPCOMING");
            } else {
              setState(wave, "CLOSED");
            }
            return;
          }
        }

        const startDate = wave.start_date ? new Date(wave.start_date) : null;
        const endDate = wave.end_date ? new Date(wave.end_date) : null;

        if (startDate && startDate > now) {
          setState(wave, "UPCOMING");
        } else if (endDate && endDate < now) {
          setState(wave, "CLOSED");
        } else if (isTrueish(wave.is_active)) {
          setState(wave, "ACTIVE");
          activeWave = wave;
        } else {
          setState(wave, "NOT_ACTIVE");
        }
      });

      if (!activeWave && waves.length > 0) {
        activeWave = waves.find((wave) => isTrueish(wave.is_active)) || waves[0];
      }

      if (activeWave && !waves.some((wave) => wave._state === "ACTIVE")) {
        setState(activeWave, "ACTIVE");
      }

      return waves;
    }

    const renderEmptyState = (container) => {
      container.innerHTML = `
        <div class="text-center py-12 col-span-full">
          <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <i class="bi bi-calendar-x text-gray-400 text-3xl"></i>
          </div>
          <h3 class="text-xl font-semibold text-gray-700 mb-2">${translateText("sections.gelombang.emptyTitle")}</h3>
          <p class="text-gray-500">${translateText("sections.gelombang.emptyDescription")}</p>
        </div>
      `;
    };

    const renderErrorState = (container) => {
      container.innerHTML = `
        <div class="text-center py-12 col-span-full">
          <i class="bi bi-exclamation-triangle text-red-500 text-4xl mb-3"></i>
          <p class="text-gray-600">${translateText("sections.gelombang.error")}</p>
        </div>
      `;
    };

    function formatDate(dateString) {
      try {
        if (!dateString) return "-";

        // Parse the date string
        const date = new Date(dateString);
        if (isNaN(date.getTime())) {
          // If invalid date, strip any "pukul" text and return
          return String(dateString).replace(/\s*pukul\s*\d{1,2}[.:]\d{2}.*/gi, "").trim() || "-";
        }

        // Extract only date parts - this ensures NO time
        const day = date.getDate();
        const month = date.getMonth();
        const year = date.getFullYear();

        // Format manually without any time component
        const docLang = document.documentElement.getAttribute("lang") || "id";
        const monthNames = docLang.startsWith("en")
          ? ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]
          : ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"];

        return `${day} ${monthNames[month]} ${year}`;
      } catch (error) {
        // Fallback: strip pukul text
        return String(dateString).replace(/\s*pukul\s*\d{1,2}[.:]\d{2}.*/gi, "").trim() || "-";
      }
    }

	    async function loadGelombangAktif({ forceReload = false } = {}) {
	      const container = document.getElementById("gelombangContainer");
	      if (!container) return;

	      try {
	        const fetchOptions = forceReload ? { cache: "no-store" } : undefined;
	        const listResponse = await fetch("/api/get_gelombang_list", fetchOptions);
	        const listResult = await listResponse.json();

        if (!listResult.ok || !Array.isArray(listResult.data) || listResult.data.length === 0) {
          renderEmptyState(container);
          return;
        }

	        let activeId = null;
	        try {
	          const activeResponse = await fetch("/api/gelombang_active", fetchOptions);
	          const activeResult = await activeResponse.json();
	          if (activeResult.ok && activeResult.data && activeResult.data.id !== undefined) {
	            const parsedId = Number(activeResult.data.id);
	            if (Number.isFinite(parsedId)) {
              activeId = parsedId;
            }
          }
        } catch (error) {
          console.warn("[GELOMBANG_ACTIVE] Failed to fetch active gelombang:", error);
        }

        const lang = getContentLanguage();
        const gelombangList = decorateGelombang(listResult.data, activeId);
        const cardsHTML = gelombangList
          .map((gelombang) => {
            const stateKey = gelombang._state || "NOT_ACTIVE";
            const colors = COLOR_MAP[gelombang._color] || COLOR_MAP.gray;
            const badgeText = getStatusBadgeText(stateKey);
            const buttonLabel = getButtonLabel(stateKey);
            const displayName = translateWaveName(gelombang.nama, lang);

            // Dynamic icon based on status
            let statusIcon = "bi-calendar-check"; // default
            if (stateKey === "ACTIVE") {
              statusIcon = "bi-unlock-fill"; // Dibuka
            } else if (stateKey === "UPCOMING") {
              statusIcon = "bi-clock-fill"; // Segera
            } else if (stateKey === "CLOSED") {
              statusIcon = "bi-x-circle-fill"; // Tutup
            }

            let buttonHTML = "";
            let statusHTML = "";

            if (stateKey === "ACTIVE") {
              buttonHTML = `<a href="/daftar.html" class="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg inline-block text-center transition shadow-md hover:shadow-lg">
                <i class="bi bi-pencil-square mr-2"></i>${buttonLabel}
              </a>`;
              statusHTML = `<div class="bg-green-50 rounded-lg p-3 mb-4"><p class="text-sm text-green-700 font-medium">${badgeText}</p></div>`;
            } else if (stateKey === "UPCOMING") {
              buttonHTML = `<button class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg cursor-default" disabled>
                <i class="bi bi-clock mr-2"></i>${buttonLabel}
              </button>`;
              statusHTML = `<div class="bg-blue-50 rounded-lg p-3 mb-4"><p class="text-sm text-blue-700 font-medium">${badgeText}</p></div>`;
            } else if (stateKey === "CLOSED") {
              buttonHTML = `<button class="w-full bg-gray-300 text-gray-600 cursor-not-allowed font-semibold py-3 px-6 rounded-lg" disabled>
                <i class="bi bi-x-circle mr-2"></i>${buttonLabel}
              </button>`;
              statusHTML = `<div class="bg-gray-50 rounded-lg p-3 mb-4"><p class="text-sm text-gray-500 font-medium">${badgeText}</p></div>`;
            } else {
              buttonHTML = `<button class="w-full bg-gray-300 text-gray-600 cursor-not-allowed font-semibold py-3 px-6 rounded-lg" disabled>
                <i class="bi bi-info-circle mr-2"></i>${buttonLabel}
              </button>`;
              statusHTML = `<div class="bg-gray-50 rounded-lg p-3 mb-4"><p class="text-sm text-gray-500 font-medium">${badgeText}</p></div>`;
            }

            return `
              <div class="bg-white rounded-2xl p-6 shadow-xl border-2 ${colors.border} relative overflow-hidden hover:shadow-2xl transition">
                <div class="absolute top-0 right-0 ${colors.badge} text-white px-4 py-2 rounded-bl-lg text-sm font-semibold">${gelombang._label}</div>
                <div class="text-center mt-4">
                  <div class="w-16 h-16 ${colors.icon} rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                    <i class="bi ${statusIcon} text-white text-2xl"></i>
                  </div>
                  <h3 class="text-xl font-bold mb-2 text-gray-800">${escapeHtml(displayName)}</h3>
                  <div class="space-y-2 mb-4">
                    <div class="flex items-center justify-center text-gray-600">
                      <i class="bi bi-calendar-event mr-2 ${colors.iconText}"></i>
                      <span class="text-sm">${formatDate(gelombang.start_date)} - ${formatDate(gelombang.end_date)}</span>
                    </div>
                    <div class="flex items-center justify-center text-gray-600">
                      <i class="bi bi-mortarboard mr-2 ${colors.iconText}"></i>
                      <span class="text-sm font-semibold">${getYearText(gelombang.tahun_ajaran)}</span>
                    </div>
                  </div>
                  ${statusHTML}
                  ${buttonHTML}
                </div>
              </div>
            `;
          })
          .join("");

        container.innerHTML = cardsHTML;
      } catch (error) {
        console.error("[GELOMBANG_LIST] Error:", error);
        renderErrorState(container);
      }
    }

    const getContentLanguage = () => {
      const code =
        typeof window.__lang === "function" ? window.__lang() : "id";
      return (code || "id").toLowerCase().startsWith("en") ? "en" : "id";
    };

    function escapeHtml(value = "") {
      return String(value).replace(/[&<>"']/g, (char) => {
        switch (char) {
          case "&":
            return "&amp;";
          case "<":
            return "&lt;";
          case ">":
            return "&gt;";
          case '"':
            return "&quot;";
          case "'":
            return "&#39;";
          default:
            return char;
        }
      });
    }

    const translateWaveName = (name = "", lang = "id") => {
      if (!name) return "";
      if (lang !== "en") return name;
      return name.replace(/gelombang/gi, (match) => {
        if (match === match.toUpperCase()) return "PERIOD";
        if (match[0] === match[0].toUpperCase()) return "Period";
        return "period";
      });
    };

    const formatWhyContent = (text) =>
      text ? escapeHtml(text).replace(/\r?\n/g, "<br />") : "";

    const selectLocalizedField = (data, key, lang) => {
      if (!data || !key) return "";
      const normalizedLang = lang === "en" ? "en" : "id";
      const fallbackLang = normalizedLang === "id" ? "en" : "id";
      const value = data[key];

      if (value && typeof value === "object") {
        const candidate = value[normalizedLang];
        if (typeof candidate === "string" && candidate.trim()) {
          return candidate.trim();
        }
        const fallbackValue = value[fallbackLang];
        if (typeof fallbackValue === "string" && fallbackValue.trim()) {
          return fallbackValue.trim();
        }
      }

      const directKey = `${key}_${normalizedLang}`;
      if (
        typeof data[directKey] === "string" &&
        data[directKey].trim()
      ) {
        return data[directKey].trim();
      }

      if (typeof value === "string" && value.trim()) {
        if (normalizedLang === "id") return value.trim();
      }

      const fallbackKey = `${key}_${fallbackLang}`;
      if (
        typeof data[fallbackKey] === "string" &&
        data[fallbackKey].trim()
      ) {
        return data[fallbackKey].trim();
      }

      return "";
    };

    let whySectionDataCache = null;

    function renderWhySection(data) {
      const container = document.getElementById("whySectionContent");
      if (!container) return;

      if (!data) {
        showDefaultWhyContent();
        return;
      }

      const lang = getContentLanguage();
      const title = selectLocalizedField(data, "title", lang);
      const subtitle = selectLocalizedField(data, "subtitle", lang);
      const content = selectLocalizedField(data, "content", lang);

      const fallbackTitle = translateText("sections.why.title");
      const fallbackSubtitle = translateText("sections.why.subtitle");
      const fallbackContent = translateText("sections.why.description");

      const titleHtml = escapeHtml(title || fallbackTitle);
      const subtitleHtmlText = escapeHtml(subtitle || fallbackSubtitle);
      const contentHtml = content
        ? formatWhyContent(content)
        : escapeHtml(fallbackContent);

      const subtitleHtml = subtitleHtmlText
        ? `<h3 class="text-xl lg:text-2xl font-semibold text-brand-900 mb-4">${subtitleHtmlText}</h3>`
        : "";

      container.innerHTML = `
        <!-- Left Column: Title -->
        <div class="flex flex-col justify-center">
          <h2 class="text-4xl lg:text-5xl xl:text-6xl font-bold text-brand-800 leading-tight mb-4 lg:mb-0">
            ${title ? escapeHtml(title) : resolvedTitle}
          </h2>
        </div>
        
        <!-- Right Column: Card -->
        <div class="relative">
          <div class="bg-gradient-to-br from-brand-50 to-white border-l-4 border-brand-600 rounded-2xl shadow-lg p-8 lg:p-10">
            ${subtitleHtml}
            <p class="text-gray-700 leading-relaxed">
              ${contentHtml}
            </p>
          </div>
        </div>
      `;
    }

    async function loadWhySection({ forceReload = false } = {}) {
      if (!forceReload && whySectionDataCache) {
        renderWhySection(whySectionDataCache);
        return;
      }

      try {
        const response = await fetch("/api/why_section_list");
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        const result = await response.json();

        if (!result.ok || !result.data) {
          whySectionDataCache = null;
          showDefaultWhyContent();
          return;
        }

        whySectionDataCache = result.data;
        renderWhySection(whySectionDataCache);
      } catch (error) {
        console.error("[WHY_SECTION] Error:", error);
        whySectionDataCache = null;
        showDefaultWhyContent();
      }
    }

    function showDefaultWhyContent() {
      const container = document.getElementById("whySectionContent");
      if (!container) return;

      container.innerHTML = `
        <!-- Left Column: Title -->
        <div class="flex flex-col justify-center">
          <h2 class="text-4xl lg:text-5xl xl:text-6xl font-bold text-brand-800 leading-tight mb-4 lg:mb-0">
            ${translateText("sections.why.title")}
          </h2>
        </div>
        
        <!-- Right Column: Card -->
        <div class="relative">
          <div class="bg-gradient-to-br from-brand-50 to-white border-l-4 border-brand-600 rounded-2xl shadow-lg p-8 lg:p-10">
            <h3 class="text-xl lg:text-2xl font-semibold text-brand-900 mb-4">
              ${translateText("sections.why.subtitle")}
            </h3>
            <p class="text-gray-700 leading-relaxed">
              ${translateText("sections.why.description")}
            </p>
          </div>
        </div>
      `;
    }

    // ===== BERITA PUBLISHED =====
	    async function loadBeritaPublished({ forceReload = false } = {}) {
	      const container = document.getElementById("beritaContainer");
	      if (!container) return;

	      try {
	        const fetchOptions = forceReload ? { cache: "no-store" } : undefined;
	        const response = await fetch("/api/berita_items?published_only=true", fetchOptions);
	        const result = await response.json();

        if (!result.ok || !Array.isArray(result.data) || result.data.length === 0) {
          container.innerHTML = `
            <div class="text-center py-12 col-span-full">
              <div class="w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="bi bi-newspaper text-gray-400 text-3xl"></i>
              </div>
              <h3 class="text-xl font-semibold text-gray-700 mb-2">${translateText("sections.berita.empty")}</h3>
            </div>
          `;
          return;
        }

        const lang = getContentLanguage();
        // Sort by published_date atau created_at (newest first)
        const sortedBerita = [...result.data].sort((a, b) => {
          const dateA = a.published_date || a.created_at;
          const dateB = b.published_date || b.created_at;
          return new Date(dateB) - new Date(dateA);
        });

        const [featuredBerita, ...otherBerita] = sortedBerita;

	        const buildImageUrl = (berita) => {
	          if (berita.image_url && berita.image_url.trim() !== "") {
	            return berita.image_url;
	          }
	          return "/assets/img/photo-placeholder.svg";
	        };

        const extractContent = (berita) => {
          const raw =
            (lang === "en" ? berita.content_en : berita.content_id) ||
            berita.content_id ||
            berita.content_en ||
            "";
          const text = raw.replace(/<[^>]+>/g, "");
          return text.trim();
        };

        const getTitle = (berita) =>
          (lang === "en" ? berita.title_en : berita.title_id) ||
          berita.title_id ||
          berita.title_en ||
          "";

        const getDetailUrl = (berita) => {
          if (!berita) return "#";
          if (berita.slug) return `/berita/${encodeURIComponent(berita.slug)}`;
          if (berita.id) return `/berita.html?id=${encodeURIComponent(berita.id)}`;
          return "#";
        };

        const buildFeaturedCard = (berita) => {
          if (!berita) return "";
          const title = getTitle(berita);
          const content = extractContent(berita);
          const excerpt =
            content.length > 180 ? `${content.substring(0, 180)}...` : content;
          const imageUrl = buildImageUrl(berita);
          const dateText = formatDate(berita.published_date || berita.created_at);
          const detailUrl = getDetailUrl(berita);

          return `
            <article class="featured-berita bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-100">
              <div class="featured-image relative overflow-hidden">
                <img
                  src="${escapeHtml(imageUrl)}"
                  alt="${escapeHtml(title)}"
                  class="w-full h-full object-cover transition-transform duration-500 hover:scale-105"
	                  onerror="this.src='/assets/img/photo-placeholder.svg'"
                />
                <div class="absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"></div>
              </div>
              <div class="p-6 lg:p-8">
                <div class="flex items-center text-sm text-gray-500 mb-3">
                  <i class="bi bi-calendar3 mr-2 text-brand-600"></i>
                  <span>${dateText}</span>
                </div>
                <h3 class="text-2xl lg:text-3xl font-bold text-gray-900 mb-4 leading-tight">
                  ${escapeHtml(title)}
                </h3>
                <p class="text-gray-600 mb-6 leading-relaxed line-clamp-3">
                  ${escapeHtml(excerpt)}
                </p>
                <a href="${detailUrl}" class="inline-flex items-center text-brand-600 font-semibold hover:text-brand-700 transition text-base">
                  ${translateText("sections.berita.readMore")}
                  <i class="bi bi-arrow-right ml-2"></i>
                </a>
              </div>
            </article>
          `;
        };

        const buildListCard = (berita) => {
          const title = getTitle(berita);
          const content = extractContent(berita);
          const excerpt =
            content.length > 120 ? `${content.substring(0, 120)}...` : content;
          const imageUrl = buildImageUrl(berita);
          const dateText = formatDate(berita.published_date || berita.created_at);
          const detailUrl = getDetailUrl(berita);

          return `
            <article class="flex gap-4 bg-white border border-gray-100 rounded-2xl p-4 shadow-md hover:shadow-lg hover:-translate-y-0.5 transition-all">
              <div class="w-24 h-20 rounded-xl overflow-hidden flex-shrink-0">
                <img
                  src="${escapeHtml(imageUrl)}"
                  alt="${escapeHtml(title)}"
                  class="w-full h-full object-cover"
	                  onerror="this.src='/assets/img/photo-placeholder.svg'"
                />
              </div>
              <div class="flex-1">
                <div class="text-xs text-gray-500 flex items-center gap-2 mb-1">
                  <i class="bi bi-calendar3 text-brand-600"></i>
                  <span>${dateText}</span>
                </div>
                <h4 class="text-base font-semibold text-gray-900 mb-1 line-clamp-2 leading-snug">
                  ${escapeHtml(title)}
                </h4>
                <p class="text-sm text-gray-500 mb-2 line-clamp-2">
                  ${escapeHtml(excerpt)}
                </p>
                <a href="${detailUrl}" class="text-brand-600 font-semibold text-sm inline-flex items-center hover:text-brand-700">
                  ${translateText("sections.berita.readMore")}
                  <i class="bi bi-arrow-right ml-1"></i>
                </a>
              </div>
            </article>
          `;
        };

        const featuredHTML = buildFeaturedCard(featuredBerita);
        const listHTML = otherBerita
          .slice(0, 4)
          .map((berita) => buildListCard(berita))
          .join("");

        const sideColumn =
          listHTML ||
          `<div class="bg-white rounded-2xl border border-dashed border-gray-200 p-6 text-center text-gray-500">
            ${translateText("sections.berita.empty")}
          </div>`;

        container.innerHTML = `
          <div>${featuredHTML}</div>
          <div class="space-y-4">${sideColumn}</div>
        `;
      } catch (error) {
        console.error("[BERITA] Error loading news:", error);
        container.innerHTML = `
          <div class="text-center py-12 col-span-full">
            <i class="bi bi-exclamation-triangle text-red-500 text-4xl mb-3"></i>
            <p class="text-gray-600">Gagal memuat berita. Silakan refresh halaman.</p>
          </div>
        `;
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      loadGelombangAktif();
      loadWhySection();
      loadBeritaPublished();
    });

    window.addEventListener("i18n:languageChanged", () => {
      loadGelombangAktif();
      loadBeritaPublished();
      if (whySectionDataCache) {
        renderWhySection(whySectionDataCache);
      } else {
        loadWhySection();
      }
    });

    window.addEventListener("storage", (event) => {
      if (event.key === "why_section_update") {
        whySectionDataCache = null;
        loadWhySection({ forceReload: true });
      }
    });

    window.addEventListener("storage", (event) => {
      if (event.key === "gelombang_update") {
        try {
          JSON.parse(event.newValue);
          console.log('[GELOMBANG] ğŸ“¡ Received update from admin (storage event)');
        } catch (error) {
          console.log('[GELOMBANG] Admin updated gelombang (legacy format), reloading...');
        }
        setTimeout(() => {
          loadGelombangAktif();
        }, 500);
        if (typeof toastr !== "undefined" && toastr.info) {
          toastr.info(translateText("sections.gelombang.toast.updated"));
        }
      }
    });

    window.addEventListener("gelombangUpdated", () => {
      setTimeout(() => {
        loadGelombangAktif();
      }, 500);
    });

	    setInterval(() => {
	      if (!document.hidden) {
	        loadGelombangAktif();
	      }
	    }, 60000);
	  </script>
	  <!-- Supabase Real-Time Sync (Optional) - lazy loaded to keep initial load fast -->
	  <script>
	    (function () {
	      'use strict';

	      const SUPABASE_URL = 'https://sxbvadzcwpaovkhghttv.supabase.co';
	      const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InN4YnZhZHpjd3Bhb3ZraGdodHR2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExMDg4MDYsImV4cCI6MjA3NjY4NDgwNn0.miJeKmsNgjgS4fWegGlwrxF_cPUoZBT0YKl1oxmmXTE';

	      const startRealtime = async () => {
	        try {
	          const mod = await import('https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm');
	          const supabase = mod.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

	          const channel = supabase
	            .channel('gelombang-changes-public')
	            .on('postgres_changes', {
	              event: '*',
	              schema: 'public',
	              table: 'gelombang'
	            }, () => {
	              setTimeout(() => {
	                if (typeof loadGelombangAktif === 'function') {
	                  loadGelombangAktif({ forceReload: true });
	                }
	              }, 300);
	            })
	            .subscribe();

	          window.addEventListener('beforeunload', () => {
	            try { supabase.removeChannel(channel); } catch (e) { }
	          });
	        } catch (e) {
	          // Optional feature: fail silently
	        }
	      };

	      const schedule = () => {
	        if ('requestIdleCallback' in window) {
	          window.requestIdleCallback(() => startRealtime(), { timeout: 4000 });
	        } else {
	          setTimeout(startRealtime, 2000);
	        }
	      };

	      if (document.readyState === 'loading') {
	        document.addEventListener('DOMContentLoaded', schedule, { once: true });
	      } else {
	        schedule();
	      }
	    })();
	  </script>

  <!-- Image Slider Script (Card Minimalis - Slide Animation) -->
  <script>
    /**
     * Image Slider Section (Card Minimalis dengan Slide Animation)
     * Animasi geser ke samping - NO FADE
     */
    let currentImageSlideIndex = 0;
    let imageSliderInterval = null;
    let sliderTrack = null;

    /**
     * Load images from API for slider section
     */
	    async function loadImageSlider() {
	      try {
	        const response = await fetch('/api/hero_images_list', { cache: 'no-cache' });
	        const result = await response.json();

        // Get slider track element
        sliderTrack = document.getElementById('sliderTrack');
        if (!sliderTrack) {
          console.error('[IMAGE_SLIDER] âŒ Slider track not found!');
          return;
        }

	        if (!result.ok || !result.data || result.data.length === 0) {
	          // Reset position to 0
	          sliderTrack.style.transform = 'translateX(0)';
	          return;
	        }

	        // Remove fallback gradient
	        const fallback = document.getElementById('sliderFallback');
	        if (fallback) {
	          fallback.remove();
	        }

	        // Clear track
	        sliderTrack.innerHTML = '';

	        // Create slide elements
	        result.data.forEach((image, index) => {
	          let cleanUrl = image.image_url;
	          if (cleanUrl) {
	            cleanUrl = cleanUrl.trim().replace(/\?$/, '');
	          }
	          if (!cleanUrl) return;

          const slideDiv = document.createElement('div');
          slideDiv.className = 'slider-slide';

          // Set background image - NO opacity, NO fade, just background
          slideDiv.style.backgroundImage = `url("${cleanUrl}")`;
          slideDiv.style.backgroundSize = 'cover';
          slideDiv.style.backgroundPosition = 'center';
          slideDiv.style.backgroundRepeat = 'no-repeat';

	          slideDiv.dataset.slideIndex = index;
	          slideDiv.dataset.imageUrl = cleanUrl;
	          sliderTrack.appendChild(slideDiv);
	        });

        // Reset to first slide
        currentImageSlideIndex = 0;
        updateSliderPosition();

	        // Start auto-slider if more than 1 image
	        if (result.data.length > 1) {
	          startImageSlider();
	        }

	      } catch (error) {
	        console.error('[IMAGE_SLIDER] âŒ Error loading images:', error);
	      }
	    }

    /**
     * Update slider position using translateX (SLIDE animation, NO FADE)
     */
    function updateSliderPosition() {
      if (!sliderTrack) return;

      // Calculate translateX: move track to the left by current index * 100%
      const translateX = -currentImageSlideIndex * 100;
      sliderTrack.style.transform = `translateX(${translateX}%)`;

      console.log('[IMAGE_SLIDER] Position updated to index:', currentImageSlideIndex, 'translateX:', translateX + '%');
    }

    /**
     * Start auto-slider (4 seconds per slide)
     */
    function startImageSlider() {
      if (imageSliderInterval) {
        clearInterval(imageSliderInterval);
      }

      imageSliderInterval = setInterval(() => {
        nextImageSlide();
      }, 4000); // 4 seconds
    }

    /**
     * Move to next slide (SLIDE animation)
     */
    function nextImageSlide() {
      if (!sliderTrack) return;

      const slides = sliderTrack.querySelectorAll('.slider-slide');
      if (slides.length === 0) return;

      // Calculate next index (loop back to 0 after last)
      currentImageSlideIndex = (currentImageSlideIndex + 1) % slides.length;

      // Update position with slide animation (translateX)
      updateSliderPosition();

      console.log('[IMAGE_SLIDER] Slide changed to index:', currentImageSlideIndex);
    }

    /**
     * Stop slider
     */
    function stopImageSlider() {
      if (imageSliderInterval) {
        clearInterval(imageSliderInterval);
        imageSliderInterval = null;
        console.log('[IMAGE_SLIDER] Slider stopped');
      }
    }

    /**
     * Reset slider to first slide
     */
    function resetImageSlider() {
      currentImageSlideIndex = 0;
      updateSliderPosition();
    }

    // Load images on page load
    document.addEventListener('DOMContentLoaded', loadImageSlider);

    // Pause slider when page is hidden (performance optimization)
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        stopImageSlider();
      } else {
        if (sliderTrack) {
          const slides = sliderTrack.querySelectorAll('.slider-slide');
          if (slides.length > 1) {
            startImageSlider();
          }
        }
      }
    });

    // ===== REAL-TIME SYNC: Listen to hero_images changes =====
    window.addEventListener('load', function () {
      if (typeof supabase !== 'undefined') {
        const imageChannel = supabase
          .channel('image-slider-public')
          .on('postgres_changes', {
            event: '*',
            schema: 'public',
            table: 'hero_images'
          }, (payload) => {
            console.log('[IMAGE_SLIDER] ğŸ”„ Images changed from admin:', payload);
            console.log('[IMAGE_SLIDER] ğŸ”„ Reloading slider...');

            // Reload images
            stopImageSlider();
            setTimeout(() => {
              loadImageSlider();
            }, 500);
          })
          .subscribe((status) => {
            if (status === 'SUBSCRIBED') {
              console.log('[IMAGE_SLIDER] ğŸ§ Subscribed to real-time updates');
            }
          });

        // Cleanup
        window.addEventListener('beforeunload', () => {
          supabase.removeChannel(imageChannel);
        });
      }
    });
  </script>

  <script>
    (function () {
      const blob = document.getElementById("yellowBlob");
      if (!blob) return;

      const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)");
      const supportsScrollTimeline =
        typeof CSS !== "undefined" && typeof CSS.supports === "function" && CSS.supports("animation-timeline: scroll()");

      if (supportsScrollTimeline) {
        blob.dataset.cssParallax = "true";
        return;
      }

      if (prefersReducedMotion.matches) {
        blob.style.transform = "translate3d(0, 0, 0)";
        return;
      }

      const k = 0.6;
      let latestY = window.scrollY || 0;
      let ticking = false;

      const clamp = (value, min, max) => Math.min(Math.max(value, min), max);

      const applyParallax = () => {
        const offset = clamp(-latestY * k, -40, 0);
        blob.style.transform = `translate3d(0, ${offset}px, 0)`;
        ticking = false;
      };

      const onScroll = () => {
        latestY = window.scrollY || 0;
        if (!ticking) {
          ticking = true;
          requestAnimationFrame(applyParallax);
        }
      };

      window.addEventListener("scroll", onScroll, { passive: true });
      applyParallax();

      const handleMotionChange = (event) => {
        if (event.matches) {
          window.removeEventListener("scroll", onScroll);
          blob.style.transform = "translate3d(0, 0, 0)";
        } else {
          window.addEventListener("scroll", onScroll, { passive: true });
          applyParallax();
        }
      };

      if (typeof prefersReducedMotion.addEventListener === "function") {
        prefersReducedMotion.addEventListener("change", handleMotionChange);
      } else if (typeof prefersReducedMotion.addListener === "function") {
        prefersReducedMotion.addListener(handleMotionChange);
      }
    })();
  </script>
  <script src="/assets/js/app.js?v=10" defer></script>
  <script src="/assets/js/navbar.js?v=10" defer></script>
  <script src="/assets/js/pwa.js?v=10" defer></script>
  <script src="/assets/js/install-button.js?v=10" defer></script>
  <script src="/assets/js/scroll-animations.js?v=10" defer></script>
  <script src="/assets/js/hero-carousel.js?v=10" defer></script>

	  <!-- Hero Carousel Images Loader - Load santri images from database -->
	  <script>
	    document.addEventListener('DOMContentLoaded', async function () {
	      'use strict';

	      const sleep = (ms) => new Promise((r) => setTimeout(r, ms));

	      function isAllowedHeroCarouselUrl(url) {
	        if (!url || typeof url !== 'string') return false;
	        try {
	          // Support both absolute and relative URLs
	          const parsed = new URL(url, window.location.origin);
	          return parsed.pathname.includes('/storage/v1/object/public/hero-carousel/');
	        } catch (e) {
	          return false;
	        }
	      }

	      async function loadHeroCarouselImages() {
	        try {
	          console.log('[HERO_IMAGES] Loading santri images from database...');

		          const response = await fetch('/api/index?action=hero_carousel_list', { cache: 'no-cache' });

	          if (!response.ok) {
	            console.warn('[HERO_IMAGES] API returned status:', response.status);
	            return false;
	          }

	          const result = await response.json();

	          console.log('[HERO_IMAGES] API Response:', result);

	          if (!result.ok) return { status: 'retry' };

	          const dataCount = Array.isArray(result.data) ? result.data.length : 0;
	          if (dataCount === 0) {
	            console.log('[HERO_IMAGES] No active images found in database');
	            return { status: 'done', updatedCount: 0, dataCount: 0 };
	          }

	          console.log('[HERO_IMAGES] Found', dataCount, 'active images');

	          let updatedCount = 0;

	          // Map slide_order to data-slide index (1 -> 0, 2 -> 1, 3 -> 2)
		          result.data.forEach((image) => {
		            const slideOrder = image.slide_order || 1;
		            const slideIndex = slideOrder - 1; // Convert 1-based to 0-based
		            const slideEl = document.querySelector(`.hero-slide-image[data-slide="${slideIndex}"] img`);

		            if (slideEl && image.image_url) {
	              if (!isAllowedHeroCarouselUrl(image.image_url)) {
	                console.warn('[HERO_IMAGES] Skipping non-supabase URL:', image.image_url);
	                return;
	              }

	              slideEl.src = image.image_url;
	              slideEl.alt = image.alt_text || 'Santri Al Ikhsan Beji';
	              updatedCount++;
	              console.log(`[HERO_IMAGES] âœ… Updated slide ${slideIndex}`);
	            }
	          });

	          console.log('[HERO_IMAGES] âœ… Total images updated:', updatedCount);
	          return { status: updatedCount > 0 ? 'done' : 'retry', updatedCount, dataCount };

	        } catch (error) {
	          console.error('[HERO_IMAGES] Error loading images:', error);
	          return { status: 'retry' };
	        }
	      }

	      // Try to load images with retry (handles cold start / slow API)
	      let delayMs = 600;
	      for (let attempt = 1; attempt <= 10; attempt++) {
	        const result = await loadHeroCarouselImages();
	        if (result?.status === 'done') break;

	        console.log(`[HERO_IMAGES] Retry ${attempt}/10 in ${delayMs}ms...`);
	        await sleep(delayMs);
	        delayMs = Math.min(Math.round(delayMs * 1.6), 4000);
	      }
	    });
	  </script>


  <style>
    /* Bubble */
    #chat-bubble {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #0d9463;
      /* hijau tua pondok - sama dengan admin button */
      color: white;
      width: 65px;
      height: 65px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      z-index: 9999;
      transition: transform 0.2s;
    }

    #chat-bubble:hover {
      transform: scale(1.1);
    }

    /* Chat Box */
    #chat-box {
      position: fixed;
      bottom: 100px;
      right: 20px;
      width: 340px;
      height: 460px;
      background: white;
      border-radius: 12px;
      display: none;
      flex-direction: column;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.25);
      z-index: 9999;
      border: 1px solid #dfdfdf;
      overflow: hidden;
    }

    #chat-header {
      background: #0d9463;
      color: white;
      padding: 14px;
      text-align: center;
      font-size: 18px;
      font-weight: bold;
    }

    #chat-messages {
      flex: 1;
      padding: 12px;
      overflow-y: auto;
      font-size: 15px;
      background: #fafafa;
    }

    .msg-user {
      background: #d4f9df;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 8px;
      text-align: right;
    }

    .msg-bot {
      background: #eeeeee;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 8px;
      text-align: left;
    }

    #typing-indicator {
      display: none;
      font-style: italic;
      color: #555;
      margin: 0 12px 10px 12px;
    }

    /* Loading dots animation */
    .dots::after {
      content: " ...";
      animation: dots 1.5s steps(4, end) infinite;
    }

    @keyframes dots {

      0%,
      20% {
        content: " .";
      }

      40% {
        content: " ..";
      }

      60% {
        content: " ...";
      }

      80%,
      100% {
        content: " .";
      }
    }

    #chat-input-area {
      display: flex;
      border-top: 1px solid #ddd;
    }

    #chat-input {
      flex: 1;
      border: none;
      padding: 12px;
      font-size: 15px;
    }

    #chat-send {
      width: 70px;
      border: none;
      background: #0d9463;
      color: white;
      cursor: pointer;
    }

    @media (max-width: 640px) {
      #chat-box {
        width: calc(100vw - 32px);
        height: 70vh;
        right: 16px;
        bottom: 90px;
      }

      #chat-bubble {
        right: 16px;
        bottom: 16px;
      }
    }
  </style>

  <div id="chat-bubble"><i class="bi bi-headset"></i></div>

  <div id="chat-box">
    <div id="chat-header">Chat Pondok</div>
    <div id="chat-messages"></div>
    <div id="typing-indicator">Bot sedang mengetik<span class="dots"></span></div>
    <div id="chat-input-area">
      <input type="text" id="chat-input" placeholder="Tulis pesan...">
      <button id="chat-send">Kirim</button>
    </div>
  </div>

  <script>
    const bubble = document.getElementById("chat-bubble");
    const box = document.getElementById("chat-box");
    const messages = document.getElementById("chat-messages");
    const input = document.getElementById("chat-input");
    const sendBtn = document.getElementById("chat-send");
    const typing = document.getElementById("typing-indicator");
    const API_URL = "https://pondok-chatbot.dewasatriaaa.workers.dev/";

    const toggleChat = () => {
      box.style.display = box.style.display === "flex" ? "none" : "flex";
    };

    const scrollToBottom = () => {
      messages.scrollTop = messages.scrollHeight;
    };

    function appendMessage(text, type) {
      messages.innerHTML += `<div class="msg-${type}">${text}</div>`;
      scrollToBottom();
    }

    function showTyping(show) {
      typing.style.display = show ? "block" : "none";
      scrollToBottom();
    }

    async function sendMessage() {
      const text = input.value.trim();
      if (!text) return;

      appendMessage(text, "user");
      input.value = "";
      showTyping(true);

      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });

        const data = await res.json();
        appendMessage(data.reply || "Maaf, terjadi kesalahan.", "bot");
      } catch (err) {
        appendMessage("Maaf, terjadi kesalahan koneksi.", "bot");
      } finally {
        showTyping(false);
      }
    }

    bubble.onclick = toggleChat;
    sendBtn.onclick = sendMessage;
    input.addEventListener("keydown", (e) => {
      if (e.key === "Enter") sendMessage();
    });
  </script>

</body>

</html>
